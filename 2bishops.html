<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mate with 2 Bishops — Endgame Lesson</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    /* === Theme Variables (Amber/Dark Theme) === */
    :root{
      /* Unified Dark/Amber Theme Variables */
      --bg-1:#1a1a1a; /* Deep charcoal */
      --bg-2:#0a0a0a; /* Pure black */
      --accent:#f59e0b; /* Tailwind Amber-500 */
      --muted:#a3a3a3; /* Gray-400 */
      --card:#1c1c1c; /* Dark card background */
      --radius:14px;
      --shadow-md: 0 6px 20px rgba(0,0,0,0.45);
      --ease:cubic-bezier(.2,.9,.3,1);
      /* Chess Board Colors */
      --light-square: #f0d9b5; 
      --dark-square: #b58863;
    }

    /* === Global Styles === */
    html,body{
      height:100%;
      margin:0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(circle at center, var(--bg-1) 0%, var(--bg-2) 100%);
      color:#e6eef6;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    .wrap{
      max-width:960px; 
      margin:32px auto;
      padding:0 28px;
      position:relative;
      min-height: calc(100vh - 120px);
    }
    .accent-shape{
      position:fixed;
      width:220px;
      height:220px;
      right:-80px;
      top:100px;
      background: radial-gradient(circle at 20% 20%, rgba(245, 158, 11, 0.15), transparent 30%),
                  radial-gradient(circle at 80% 80%, rgba(245, 158, 11, 0.08), transparent 40%);
      border-radius:50%;
      filter: blur(24px);
      pointer-events:none;
      transform:translateZ(0);
      z-index:0;
      opacity: 0.6;
    }
    
    /* === Header Styling === */
    .site-header{
      background: linear-gradient(90deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      box-shadow: var(--shadow-md);
      backdrop-filter: blur(6px);
      position:sticky;
      top:0;
      z-index:10;
    }
    .header-inner{
      max-width:960px;
      margin:0 auto;
      padding:16px 28px;
      display:flex;
      align-items:center;
      gap:20px;
    }
    .logo {
      width: 48px;
      height: 48px;
      border-radius: 8px;
      color: var(--bg-2);
      background: linear-gradient(135deg, var(--accent), #ffbf00); 
      font-size: 24px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.5);
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .logo svg { stroke: var(--bg-2); fill: var(--bg-2); }
    .header-title h1{ margin:0; font-size:1.5rem; color:#fff; letter-spacing:0.2px; }
    .header-title p{ margin:0; color:var(--muted); font-size:0.9rem; }

    /* === Card and Layout Styles === */
    .card{
      background: var(--card);
      border-radius:var(--radius);
      padding:1.5rem;
      box-shadow: var(--shadow-md);
      transition: box-shadow 0.3s ease;
      z-index: 1; /* Above accent-shape */
      position: relative;
    }
    .card h2 {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--accent);
      margin-bottom: 0.75rem;
      border-bottom: 1px solid rgba(255,255,255,0.08);
      padding-bottom: 0.5rem;
    }
    .media-grid {
      display: grid;
      gap: 1.5rem;
      grid-template-columns: 1fr;
      margin-top: 1.5rem;
    }
    @media (min-width: 768px) {
      .media-grid {
        grid-template-columns: 2fr 1fr;
      }
    }
    .media-card {
      border-radius: var(--radius);
      background-color: var(--card);
      box-shadow: var(--shadow-md);
      overflow: hidden;
    }
    .media {
      position: relative;
      width: 100%;
      padding-bottom: 56.25%; /* 16:9 for video */
      overflow: hidden;
    }
    .media-diagram {
        padding-bottom: 100%; /* 1:1 for diagram */
    }
    .media img.poster, .media-diagram img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .media iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
    .play-overlay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.7);
      color: white;
      border: 3px solid var(--accent); 
      border-radius: 50%;
      width: 4.5rem;
      height: 4.5rem;
      font-size: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.3s, transform 0.3s;
      z-index: 2;
    }
    .play-overlay:hover {
      background: rgba(245, 158, 11, 0.8);
      color: var(--bg-2); 
      transform: translate(-50%, -50%) scale(1.1);
    }
    .meta {
      padding: 1rem 1.5rem;
      flex-grow: 1;
    }
    .meta .kv {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 0.5rem;
    }
    .meta .title {
      font-size: 1.25rem;
      font-weight: 600;
      color: #fff;
      margin: 0;
    }
    .media-badge {
      background-color: var(--accent); 
      color: var(--bg-2); 
      padding: 0.25rem 0.6rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 700;
    }
    .notes-list li {
      margin-bottom: 0.5rem;
      padding-left: 1.5rem;
      position: relative;
      color: #e6eef6;
    }
    .notes-list li::before {
      content: '✔';
      color: var(--accent); 
      font-weight: 700;
      position: absolute;
      left: 0;
    }

    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-weight: 600;
      text-decoration: none;
      transition: background-color 0.2s, box-shadow 0.2s;
      font-size: 0.9rem;
      background-color: rgba(255,255,255,0.1);
      color: #fff;
      border: 1px solid rgba(255,255,255,0.15);
    }
    .btn-primary {
      background-color: var(--accent);
      color: var(--bg-2);
      box-shadow: 0 4px 10px rgba(245, 158, 11, 0.3);
      border: 1px solid var(--accent);
    }
    .btn-primary:hover {
      background-color: #d97706; /* Amber-700 */
    }
    .btn:hover {
      background-color: rgba(255,255,255,0.2);
    }

    /* === Practice Problem Styles === */
    .board {
        display: grid;
        grid-template-columns: repeat(8, 1fr);
        grid-template-rows: repeat(8, 1fr);
        width: 100%;
        max-width: 320px;
        aspect-ratio: 1 / 1;
        margin: 1.5rem auto 0.5rem auto;
        border: 4px solid var(--accent);
        box-shadow: 0 0 15px rgba(245, 158, 11, 0.5);
        position: relative;
    }
    /* File and Rank Labels */
    .board::before, .board::after {
      content: '';
      position: absolute;
      font-size: 0.75rem;
      color: var(--muted);
      z-index: 3;
    }

    .square {
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer; 
        transition: background-color 0.1s ease;
    }
    .light {
        background-color: var(--light-square);
    }
    .dark {
        background-color: var(--dark-square);
    }
    .square:hover {
        opacity: 0.9;
    }
    .square.selected {
        box-shadow: inset 0 0 0 3px #00aaff; /* Highlight selected square */
        background-color: rgba(0, 170, 255, 0.5) !important; 
        transition: none;
    }
    .piece {
        user-select: none;
        pointer-events: none; /* Do not block click on the square */
        font-size: 2.25rem;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
    }
    #feedback {
        margin-top: 0.75rem;
        font-weight: 600;
        min-height: 20px;
    }
    .feedback-success {
        color: var(--accent);
    }
    .feedback-error {
        color: #ff6464; /* Red for errors */
    }
    .message-box {
        background-color: #2a2a2a;
        padding: 1rem;
        border-radius: var(--radius);
        margin-top: 1rem;
        border: 1px solid rgba(255,255,255,0.1);
        text-align: center;
    }


    /* Footer */
    .site-footer{
        margin-top:40px;
        padding:18px;
        text-align:center;
        color:var(--muted);
        font-size:13px;
        border-top:1px solid rgba(255,255,255,0.05);
    }
  </style>
</head>
<body>
  <!-- Ambient Amber Glow Effect -->
  <div class="accent-shape" aria-hidden="true"></div>

  <!-- Header -->
  <header class="site-header">
    <div class="header-inner">
      <div class="logo" aria-hidden="true">
<h1>♗♗</h1>
      </div>
      <div class="header-title">
        <h1>Mate with 2 Bishops</h1>
        <p>Advanced cornering technique</p>
      </div>
    </div>
  </header>

  <main class="wrap">
    
    <section class="card mt-6">
      <h2>Lesson Overview</h2>
      <p class="text-gray-300">Two-bishop mate is a fundamental checkmating technique where bishops and king coordinate to drive the opposing king to the corner. This lesson demonstrates the steps and provides a practice exercise.</p>
    </section>

    <div class="media-grid">
      <!-- Video card (Main Content) -->
      <article class="media-card md:col-span-2" aria-label="Two bishops lesson video">
        <div class="media" role="region" aria-label="Video player">
          <img class="poster" 
               src="https://placehold.co/800x450/1c1c1c/f59e0b?text=Two+Bishops+Mating+Tutorial" 
               alt="Mate with 2 bishops poster" />
          <!-- Video ID for a Two Bishop Mate lesson -->
          <button class="play-overlay" aria-label="Play video" data-video-id="fR3R0_n_Q-M">▶</button>
        </div>
        <div class="meta">
          <div class="kv">
            <h3 class="title">Two Bishops vs. King: The Box Method</h3>
            <span class="media-badge">Video Lesson</span>
          </div>
          <p class="text-sm text-gray-400">Step-by-step demonstration of the key maneuvers and cornering technique.</p>
        </div>
      </article>
      
      <!-- Important Notes Card -->
      <aside class="card" aria-label="Important Notes on Two Bishops Mate">
        <h2>Key Principles</h2>
        <ul class="notes-list text-sm space-y-2">
          <li>**Centralization:** Keep the Bishops centrally located to control both diagonals.</li>
          <li>**Triangle:** Form a protective triangle with the two Bishops and advance it like a wall.</li>
          <li>**King Support:** The friendly King is essential for controlling the central squares and supporting the Bishop wall.</li>
          <li>**Cornering:** The Black King must be forced into the corner that matches the color of one of the Bishops' diagonals.</li>
          <li>**Final Mate:** The mate is delivered by a Bishop, supported by the second Bishop and the King.</li>
        </ul>
      </aside>
    </div>

    <!-- Practice Problems Section -->
    <section class="card mt-6">
      <h2>Practice Problem: Mate in 1</h2>
      <p class="text-gray-300">White to move. Find the immediate checkmate. The Black King has been successfully cornered on h8. **Click the Bishop on f7, then click the destination square (g8).**</p>
      
      <div id="chessboard-container" class="flex flex-col items-center">
        <div id="board" class="board">
          <!-- Chessboard will be rendered here by JavaScript -->
        </div>
        <div id="feedback" class="feedback message-box text-base w-full max-w-xs h-12 flex items-center justify-center">
          Click the white Bishop (f7) to select it.
        </div>
      </div>
    </section>

    <footer class="site-footer">
      © Online Chess Course — All rights reserved.
    </footer>
  </main>

  <script>
    // --- Video Player Logic ---
    document.addEventListener('click', function (e) {
      const btn = e.target.closest('.play-overlay');
      if (!btn) return;
      const container = btn.closest('.media');
      const id = btn.getAttribute('data-video-id');
      if (!id || !container) return;
      
      // Create and insert the YouTube iframe
      const iframe = document.createElement('iframe');
      iframe.src = 'https://www.youtube.com/embed/' + encodeURIComponent(id) + '?rel=0&autoplay=1';
      iframe.title = 'Lesson video';
      iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
      iframe.setAttribute('frameborder', '0');
      iframe.setAttribute('allowfullscreen', '');
      
      container.innerHTML = '';
      container.appendChild(iframe);
    });

    // --- Chess Practice Logic (Interactive) ---

    // Define the problem (Position: White King on f6, Bishops on e7 and f7, Black King on h8)
    // Correct Mate: Bf7-g8# (The Bishop on f7 delivers mate to Kh8, supported by the Bishop on e7 and the King on f6)
    const PROBLEM = {
        correctMove: "Bf5", 
        startSquare: "e7",
        targetSquare: "f6",
        pieces: { 
            // W K on h6, W B on e7, W B on e6, B K on h8
            'h6': { symbol: '♔', color: 'white' }, // White King 
            'e7': { symbol: '♗', color: 'white' }, // White Bishop 1 (Supporting piece)
            'e6': { symbol: '♗', color: 'white' }, // White Bishop 2 (Mating piece)
            'h8': { symbol: '♚', color: 'black' }  // Black King (Cornered)
        }
    };

    const boardElement = document.getElementById('board');
    const feedbackElement = document.getElementById('feedback');
    let currentBoardState = JSON.parse(JSON.stringify(PROBLEM.pieces)); // Copy initial state
    let selectedSquare = null;
    let isSolved = false;

    /**
     * Converts a square index (0-63) to chess notation (e.g., 'a8').
     * @param {number} index - The square index (0-63).
     * @returns {string} - The algebraic notation (e.g., 'a8').
     */
    function indexToSquare(index) {
        const file = String.fromCharCode('a'.charCodeAt(0) + (index % 8));
        const rank = 8 - Math.floor(index / 8);
        return file + rank;
    }
    
    /**
     * Updates the feedback message.
     * @param {string} message - The message to display.
     * @param {string} type - 'success', 'error', or 'info'.
     */
    function showFeedback(message, type) {
        feedbackElement.textContent = message;
        feedbackElement.className = 'feedback message-box text-base w-full max-w-xs h-12 flex items-center justify-center';
        if (type === 'success') {
            feedbackElement.classList.add('feedback-success');
        } else if (type === 'error') {
            feedbackElement.classList.add('feedback-error');
        }
    }

    /**
     * Renders the chess board and attaches event listeners.
     */
    function renderBoard() {
        boardElement.innerHTML = ''; // Clear existing board
        
        // Loop from 0 (a8) to 63 (h1)
        for (let i = 0; i < 64; i++) {
            const square = document.createElement('div');
            const algSquare = indexToSquare(i);
            square.dataset.square = algSquare;

            // Determine square color
            // Ranks 8, 7, 6, 5, 4, 3, 2, 1 -> Indices 0-7, 8-15, ... 56-63
            const isLight = ((i % 8) + Math.floor(i / 8)) % 2 === 0;
            square.classList.add('square', (isLight ? 'light' : 'dark')); // Corrected for standard FEN representation where a8 is dark

            // Highlight selected square
            if (selectedSquare === algSquare) {
                square.classList.add('selected');
            }
            
            // Render piece if present
            if (currentBoardState[algSquare]) {
                const pieceData = currentBoardState[algSquare];
                const piece = document.createElement('span');
                piece.classList.add('piece'); 
                piece.textContent = pieceData.symbol;
                
                // Set piece color based on Unicode (white or black pieces)
                piece.style.color = pieceData.color === 'white' ? '#eee' : '#333';
                square.appendChild(piece);
            }

            // Attach click handler
            square.addEventListener('click', () => handleSquareClick(algSquare));

            boardElement.appendChild(square);
        }
    }

    /**
     * Handles the user's click on a square.
     * @param {string} squareId - The algebraic notation of the clicked square.
     */
    function handleSquareClick(squareId) {
        if (isSolved) {
            showFeedback("The problem is already solved! Click refresh to practice again.", 'info');
            return;
        }

        const pieceOnSquare = currentBoardState[squareId];

        // 1. If no square is selected and the user clicks a piece (White Bishop)
        if (!selectedSquare && pieceOnSquare && pieceOnSquare.color === 'white') {
            if (pieceOnSquare.symbol !== '♗') {
                 showFeedback("You must move a Bishop to deliver mate. Select the Bishop on e7.", 'error');
                 return;
            }
            selectedSquare = squareId;
            showFeedback(`Bishop selected on ${squareId}. Click the target square (f6).`, 'info');
        } 
        // 2. If a square is selected and the user clicks a target square
        else if (selectedSquare) {
            const start = selectedSquare;
            const target = squareId;
            
            // Check if it's the correct move: Bf7-g8
            if (start === PROBLEM.startSquare && target === PROBLEM.targetSquare) {
                // Correct move logic
                isSolved = true;
                
                // Perform the visual move: Move Bishop from f7 to g8 (captures the empty square, but visually delivers mate)
                const bishopPiece = currentBoardState[PROBLEM.startSquare];
                
                // Update board state
                delete currentBoardState[PROBLEM.startSquare];
                currentBoardState[PROBLEM.targetSquare] = bishopPiece;
                
                showFeedback(`Checkmate! ${PROBLEM.correctMove}# is correct!`, 'success');
            } else {
                // Incorrect move logic
                showFeedback(`Incorrect move. The mate is ${PROBLEM.correctMove}#. Try again or reset selection.`, 'error');
            }

            // Reset state and re-render the board for the final position
            selectedSquare = null;
        } else {
            // User clicked an empty or black square when nothing was selected
            showFeedback("Please select a white piece (the Bishop on f7) to start your move.", 'info');
        }
        
        // Always re-render to update highlights or piece positions
        renderBoard();
    }

    // Initialize the board when the window loads
    window.onload = function() {
        renderBoard();
        showFeedback("Click the white Bishop (e7) to select it.", 'info');
    };
  </script>
</body>
</html>
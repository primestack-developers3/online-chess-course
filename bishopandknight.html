<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mate with Bishop & Knight — Endgame Lesson</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    /* === Theme Variables (Amber/Dark Theme) === */
    :root{
      /* Unified Dark/Amber Theme Variables */
      --bg-1:#1a1a1a; /* Deep charcoal */
      --bg-2:#0a0a0a; /* Pure black */
      --accent:#f59e0b; /* Tailwind Amber-500 */
      --muted:#a3a3a3; /* Gray-400 */
      --card:#1c1c1c; /* Dark card background */
      --radius:14px;
      --shadow-md: 0 6px 20px rgba(0,0,0,0.45);
      --ease:cubic-bezier(.2,.9,.3,1);
      /* Chess Board Colors */
      --light-square: #f0d9b5; 
      --dark-square: #b58863;
    }

    /* === Global Styles === */
    html,body{
      height:100%;
      margin:0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(circle at center, var(--bg-1) 0%, var(--bg-2) 100%);
      color:#e6eef6;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    .wrap{
      max-width:960px; 
      margin:32px auto;
      padding:0 28px;
      position:relative;
      min-height: calc(100vh - 120px);
    }
    .accent-shape{
      position:fixed;
      width:220px;
      height:220px;
      left:-80px; /* Moved to left for variation */
      top:100px;
      background: radial-gradient(circle at 20% 20%, rgba(245, 158, 11, 0.15), transparent 30%),
                  radial-gradient(circle at 80% 80%, rgba(245, 158, 11, 0.08), transparent 40%);
      border-radius:50%;
      filter: blur(24px);
      pointer-events:none;
      transform:translateZ(0);
      z-index:0;
      opacity: 0.6;
    }
    
    /* === Header Styling === */
    .site-header{
      background: linear-gradient(90deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      box-shadow: var(--shadow-md);
      backdrop-filter: blur(6px);
      position:sticky;
      top:0;
      z-index:10;
    }
    .header-inner{
      max-width:960px;
      margin:0 auto;
      padding:16px 28px;
      display:flex;
      align-items:center;
      gap:20px;
    }
    .logo {
      width: 48px;
      height: 48px;
      border-radius: 8px;
      color: var(--bg-2);
      background: linear-gradient(135deg, var(--accent), #ffbf00); 
      font-size: 24px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.5);
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    /* SVG Knight & Bishop Icon */
    .logo svg { 
        fill: var(--bg-2); 
    }
    .header-title h1{ margin:0; font-size:1.5rem; color:#fff; letter-spacing:0.2px; }
    .header-title p{ margin:0; color:var(--muted); font-size:0.9rem; }

    /* === Card and Layout Styles === */
    .card{
      background: var(--card);
      border-radius:var(--radius);
      padding:1.5rem;
      box-shadow: var(--shadow-md);
      transition: box-shadow 0.3s ease;
      z-index: 1; 
      position: relative;
    }
    .card h2 {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--accent);
      margin-bottom: 0.75rem;
      border-bottom: 1px solid rgba(255,255,255,0.08);
      padding-bottom: 0.5rem;
    }
    .media-grid {
      display: grid;
      gap: 1.5rem;
      grid-template-columns: 1fr;
      margin-top: 1.5rem;
    }
    @media (min-width: 768px) {
      .media-grid {
        grid-template-columns: 2fr 1fr;
      }
    }
    .media-card {
      border-radius: var(--radius);
      background-color: var(--card);
      box-shadow: var(--shadow-md);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    .media {
      position: relative;
      width: 100%;
      padding-bottom: 56.25%; /* 16:9 for video */
      overflow: hidden;
    }
    .media-diagram {
        padding-bottom: 100%; /* 1:1 for diagram/image */
    }
    .media iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
    .media img.poster, .media-diagram img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .play-overlay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.7);
      color: white;
      border: 3px solid var(--accent); 
      border-radius: 50%;
      width: 4.5rem;
      height: 4.5rem;
      font-size: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.3s, transform 0.3s;
      z-index: 2;
    }
    .play-overlay:hover {
      background: rgba(245, 158, 11, 0.8);
      color: var(--bg-2); 
      transform: translate(-50%, -50%) scale(1.1);
    }
    .meta {
      padding: 1rem 1.5rem;
      flex-grow: 1;
    }
    .meta .kv {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 0.5rem;
    }
    .meta .title {
      font-size: 1.25rem;
      font-weight: 600;
      color: #fff;
      margin: 0;
    }
    .media-badge {
      background-color: var(--accent); 
      color: var(--bg-2); 
      padding: 0.25rem 0.6rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 700;
    }
    
    /* === Practice Section Styles === */
    .practice-section {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.5rem;
    }
    @media (min-width: 768px) {
      .practice-section {
        grid-template-columns: 1fr 1fr;
      }
    }
    .board-wrapper {
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    .board {
        display: grid;
        grid-template-columns: repeat(8, 1fr);
        grid-template-rows: repeat(8, 1fr);
        width: 100%;
        max-width: 320px;
        aspect-ratio: 1 / 1;
        margin: 0.5rem auto;
        border: 4px solid var(--accent);
        box-shadow: 0 0 15px rgba(245, 158, 11, 0.5);
    }
    .square {
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .light {
        background-color: var(--light-square);
    }
    .dark {
        background-color: var(--dark-square);
    }
    .piece {
        user-select: none;
        font-size: 2.25rem;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
    }
    #diagram-label {
        color: var(--accent);
        font-weight: 600;
        margin-top: 0.5rem;
    }


    /* Footer */
    .site-footer{
        margin-top:40px;
        padding:18px;
        text-align:center;
        color:var(--muted);
        font-size:13px;
        border-top:1px solid rgba(255,255,255,0.05);
    }
  </style>
</head>
<body>
  <!-- Ambient Amber Glow Effect -->
  <div class="accent-shape" aria-hidden="true"></div>

  <!-- Header -->
  <header class="site-header">
    <div class="header-inner">
      <div class="logo" aria-hidden="true">
<h1>♗♘</h1>
      </div>
      <div class="header-title">
        <h1>Mate with Bishop & Knight</h1>
        <p>Technique for forcing mate with a bishop and knight vs lone king</p>
      </div>
    </div>
  </header>

  <main class="wrap">
    
    <section class="card mt-6">
      <h2>Description</h2>
      <p class="text-gray-300">This lesson shows the precise method to checkmate with a bishop and knight supported by the king.
        It's an instructive endgame technique — precise coordination and tempo are required, often taking up to 35 moves to succeed. 
        Mastering this teaches deep piece cooperation.</p>
    </section>

    <div class="media-grid">
      <!-- Video card (Main Content) -->
      <article class="media-card md:col-span-2" aria-label="Bishop and knight lesson video">
        <div class="media" role="region" aria-label="Video player">
          <img class="poster" 
               src="https://placehold.co/800x450/1c1c1c/f59e0b?text=Bishop+%26+Knight+Mate+Tutorial" 
               alt="Bishop and Knight mate poster" />
          <!-- Video ID for a B+N Mate lesson -->
          <button class="play-overlay" aria-label="Play video" data-video-id="dHnz4U7qjfk">▶</button>
        </div>
        <div class="meta">
          <div class="kv">
            <h3 class="title">Bishop & Knight Mate — The W-Maneuver</h3>
            <span class="media-badge">Video Lesson</span>
          </div>
          <p class="text-sm text-gray-400">Step-by-step demonstration of the famous W-Maneuver and the final mating sequence.</p>
        </div>
      </article>
      
      <!-- Summary Card (W-Maneuver Steps) -->
      <aside class="card" aria-label="W-Maneuver Summary">
        <h3 class="title text-xl" style="color:white; margin-bottom: 0.5rem; border-bottom: none; padding-bottom: 0;">The Four-Step W-Maneuver</h3>
        <p class="text-xs text-gray-400 mb-4">The core concept to force the enemy King to the correct corner (same color as the Bishop).</p>
        
        <ul class="list-disc pl-5 text-sm text-gray-300 space-y-3">
            <li><strong class="text-accent">1. Corral:</strong> Use the King and Bishop to initially force the opposing King to the center of the board.</li>
            <li><strong class="text-accent">2. Force to Border:</strong> Use the Knight and King to push the enemy King to one of the four border ranks/files.</li>
            <li><strong class="text-accent">3. The W-Pattern:</strong> Use the Knight in a zigzag "W" pattern, supported by the Bishop, to force the King into the corner square that matches the Bishop's color.</li>
            <li><strong class="text-accent">4. Final Mate:</strong> Once trapped, the King, Bishop, and Knight coordinate closely to deliver a precise checkmate on the final corner square.</li>
        </ul>
      </aside>
    </div>
        <section class="card mt-6">
      <h2>Practice Problem: Mate in 1</h2>
      <p class="text-gray-300">White to move. Deliver the checkmate using the rook on h7. **Click the Rook (h7), then click the destination square (h8).**</p>
      
      <div id="chessboard-container" class="flex flex-col items-center">
        <div id="board" class="board">
          <!-- Chessboard will be rendered here by JavaScript -->
        </div>
        <div id="feedback" class="feedback message-box text-base w-full max-w-xs h-12 flex items-center justify-center">
          Click the white Rook (h7) to select it.
        </div>
      </div>
    </section>

        <footer class="site-footer">
      <div class="small">© Online Chess Course</div>
      <div class="small">Made with ♟️</div>
    </footer>
  </main>

    <script>
      // Video Play Button Logic
      document.querySelectorAll('.play-overlay').forEach(button => {
        button.addEventListener('click', () => {
          const videoId = button.dataset.videoId;
          const mediaDiv = button.parentElement;
          mediaDiv.innerHTML = `<iframe src="https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
        });
      });
    const PROBLEM = {
        correctMove: "Be4", 
        startSquare: "d6",
        targetSquare: "e5",
        pieces: { 
            'h6': { symbol: '♔', color: 'white' }, // White King 
            'd6': { symbol: '♗', color: 'white' }, // White Bishop (Light Squares)
            'e7': { symbol: '♘', color: 'white' }, // White Knight
            'h8': { symbol: '♚', color: 'black' }  // Black King (Cornered)
        }
    };

    const boardElement = document.getElementById('board');
    const feedbackElement = document.getElementById('feedback');
    let currentBoardState = JSON.parse(JSON.stringify(PROBLEM.pieces)); // Copy initial state
    let selectedSquare = null;
    let isSolved = false;

    /**
     * Converts a square index (0-63) to chess notation (e.g., 'a8').
     * @param {number} index - The square index (0-63).
     * @returns {string} - The algebraic notation (e.g., 'a8').
     */
    function indexToSquare(index) {
        const file = String.fromCharCode('a'.charCodeAt(0) + (index % 8));
        const rank = 8 - Math.floor(index / 8);
        return file + rank;
    }
    
    /**
     * Updates the feedback message.
     * @param {string} message - The message to display.
     * @param {string} type - 'success', 'error', or 'info'.
     */
    function showFeedback(message, type) {
        feedbackElement.textContent = message;
        // Reset classes
        feedbackElement.className = 'feedback message-box text-base w-full max-w-xs h-12 flex items-center justify-center';
        if (type === 'success') {
            feedbackElement.classList.add('feedback-success');
        } else if (type === 'error') {
            feedbackElement.classList.add('feedback-error');
        }
    }

    /**
     * Renders the chess board and attaches event listeners.
     */
    function renderBoard() {
        boardElement.innerHTML = ''; // Clear existing board
        
        // Loop from 0 (a8) to 63 (h1)
        for (let i = 0; i < 64; i++) {
            const square = document.createElement('div');
            const algSquare = indexToSquare(i);
            square.dataset.square = algSquare;

            // Determine square color
            // Standard chess boards often have a8 as a dark square.
            const isDark = ((i % 8) + Math.floor(i / 8)) % 2 === 0;
            square.classList.add('square', (isDark ? 'dark' : 'light')); 

            // Highlight selected square
            if (selectedSquare === algSquare) {
                square.classList.add('selected');
            }
            
            // Render piece if present
            if (currentBoardState[algSquare]) {
                const pieceData = currentBoardState[algSquare];
                const piece = document.createElement('span');
                piece.classList.add('piece'); 
                piece.textContent = pieceData.symbol;
                
                // Set piece color based on Unicode (white or black pieces)
                piece.style.color = pieceData.color === 'white' ? '#eee' : '#333';
                square.appendChild(piece);
            }

            // Attach click handler
            square.addEventListener('click', () => handleSquareClick(algSquare));

            boardElement.appendChild(square);
        }
    }

    /**
     * Handles the user's click on a square.
     * @param {string} squareId - The algebraic notation of the clicked square.
     */
    function handleSquareClick(squareId) {
        if (isSolved) {
            showFeedback("The problem is already solved! Click refresh to practice again.", 'info');
            return;
        }

        const pieceOnSquare = currentBoardState[squareId];

        // 1. If no square is selected and the user clicks a piece (White Bishop on d6)
        if (!selectedSquare && pieceOnSquare && pieceOnSquare.color === 'white') {
            if (squareId !== PROBLEM.startSquare || pieceOnSquare.symbol !== '♗') {
                 showFeedback("You must move the mating Bishop. Select the Bishop on " + PROBLEM.startSquare + ".", 'error');
                 return;
            }
            selectedSquare = squareId;
            showFeedback(`Bishop selected on ${squareId}. Click the target square (${PROBLEM.targetSquare}).`, 'info');
        } 
        // 2. If a square is selected and the user clicks a target square
        else if (selectedSquare) {
            const start = selectedSquare;
            const target = squareId;
            
            // Check if it's the correct move: Rh7-h8
            if (start === PROBLEM.startSquare && target === PROBLEM.targetSquare) {
                // Correct move logic
                isSolved = true;
                
                // Perform the visual move: Move Rook from h7 to h8 (captures the Black King)
                const rookPiece = currentBoardState[PROBLEM.startSquare];
                
                // Update board state: delete BK and WR from start, place WR on target
                delete currentBoardState[PROBLEM.startSquare]; // Remove WR from g1
                currentBoardState[PROBLEM.targetSquare] = rookPiece; // Place WR on h1
                currentBoardState['h8'] = { symbol: '♚', color: 'black' };  // Black King (Cornered)
                
                showFeedback(`Checkmate! ${PROBLEM.correctMove}# is correct! The ladder is complete!`, 'success');
            } else {
                // Incorrect move logic
                showFeedback(`Incorrect move. The mate is ${PROBLEM.correctMove}#. Try again or click ${PROBLEM.startSquare} to reset selection.`, 'error');
            }

            // Reset selection state (but keep the solved state if successful)
            selectedSquare = null;
        } else {
            // User clicked an empty or black square when nothing was selected
            showFeedback("Please select a white piece (the Rook on h7) to start your move.", 'info');
        }
        
        // Always re-render to update highlights or piece positions
        renderBoard();
    }

    // Initialize the board when the window loads
    window.onload = function() {
        renderBoard();
        showFeedback("Click the white Rook (h7) to select it.", 'info');
    };

  </script>
</body>
</html>